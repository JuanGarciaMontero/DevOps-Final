pipeline {
    agent any
    stages {
        stage ('Stage crea contenedor con Python') {
                   agent {
                       docker { image 'python:slim-bullseye' }
                   }
                   steps {
                       echo 'Stage con ejecuci√≥n normal, python'
                            sh 'python --version'
                            sh 'sudo apt-get install libpq-dev'
                            sh 'pip install psycopg2-binary'
                            sh 'pip install Flask-Testing psycopg2'
                            sh 'export PATH="/bin/pg_config:$PATH"'
                            sh 'pip install Flask-Testing psycopg2 pytest'
                            sh 'pytest tests/'
                            sh 'pip install coverage'
                            sh 'pytest --cov=app tests/'
                   }
        }
        }
post { always { echo "Fin del pipeline" } }              
} 